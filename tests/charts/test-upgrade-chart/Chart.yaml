apiVersion: v2
name: test-upgrade-chart
description: A test chart with upgrade annotations

type: application
version: 0.2.0
appVersion: "2.0.0"

annotations:
  datarobot.com/images: |
    - name: test-image
      image: docker.io/datarobotdev/test-image:{{.Chart.AppVersion}}
  
  upgrade.datarobot.com/pre-migration: |
    source: ">=0.1.0 <0.2.0"
    target: "0.2.0"
    description: Database schema migration required
    action: |
      ./scripts/migrate-db.sh
      ./scripts/verify-migration.sh
  
  upgrade.datarobot.com/backup: |
    source: "*"
    target: "2.x"
    description: Run backup before upgrade
    action: |
      ./scripts/backup.sh
      ./scripts/verify-backup.sh
