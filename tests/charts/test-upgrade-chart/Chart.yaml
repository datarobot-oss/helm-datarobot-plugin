apiVersion: v2
name: test-upgrade-chart
description: A test chart with upgrade annotations

type: application
version: 0.2.0
appVersion: "2.0.0"

annotations:
  datarobot.com/images: |
    - name: test-image
      image: docker.io/datarobotdev/test-image:{{.Chart.AppVersion}}
  
  upgrade.datarobot.com/always-run: |
    source: ""
    target: ""
    description: This runs for all upgrades
    action: echo "Always executed"
  
  upgrade.datarobot.com/specific-upgrade: |
    source: "0.1.x"
    target: "0.2.0"
    description: Runs when upgrading from 0.1.x to 0.2.0
    action: |
      ./scripts/migrate.sh
      ./scripts/verify-migration.sh
  
  upgrade.datarobot.com/to-v2: |
    source: ""
    target: "2.x"
    description: Runs when upgrading to any 2.x version
    action: |
      ./scripts/v2-setup.sh
      ./scripts/verify-v2.sh
